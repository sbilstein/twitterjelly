SELECT tfidf.token, tfidf.c2, tfidf.c, log(tfidf.c2/tfidf.c) as score FROM
(SELECT token, COUNT(*) AS c, SUM(CASE WHEN user='snoopdogg' THEN 1 ELSE 0 END) AS c2 FROM token_user_mapping GROUP BY token ORDER BY c DESC) as tfidf
ORDER BY score DESC